<h1><%= @topic.name %></h1>
<section id="topic-section">
<table>
  <tr>
    <td><h3><%= topic_date_format(@topic.publish_date) %></h3></td>
  </tr>
  <tr>
    <td><%= simple_format("#{@topic.summary}") %></td>
  </tr>
</table>

<%= button_to "Edit Topic", edit_topic_path(@topic), display: :inline %>
<%= button_to "Back to Topic list", topics_path %>

<fieldset id="hootsuite-radio-set">
<legend>Hoot Suite file extract</legend>
  <%= form_tag({controller: "posts", action: "extract"}, method: "get") do %>
    <%= hidden_field_tag 'topic', @topic.id %>
    <%= collection_radio_buttons(:platform, :id, Platform.all, :id, :name) %>
    <%= submit_tag("Extract for Hootsuite") %>
  <% end %>
</fieldset>
</section>

<section id="handles-section">
<fieldset>
<legend>Handles used in this topic</legend>
  <div id="handles">
      <%= formatted_handles(@topic.handles) %>
  </div>
</fieldset>
<!-- <hr> -->
</section>

<section id="posts-section">
<fieldset id="post-form">
<legend>Post editor</legend>
  <% if @post %>
    <%= render partial: 'posts/form', locals: {post: @post} %>
  <% else %>
    <%= render partial: 'posts/form', locals: {post: Post.new(topic_id: @topic.id)} %>
  <% end %>
</fieldset>
<hr>

<table id="posts-table">
  <thead>
    <tr>
      <td>Platform</td>
      <td>Content</td>
      <td>Count</td>
      <td>URL</td>
      <td>Scheduled for</td>
      <td>Status</td>
      <td></td>
    </tr>
  </thead>
  <tbody id="post-table-body">
  <%# @topic.posts.each do |post| %>
    <%= render @topic.posts.includes(:platform) %>
  <%# end %>
  </tbody>
</table>

</section>