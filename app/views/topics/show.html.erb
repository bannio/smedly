<h1><%= @topic.name %></h1>

<table>
  <tr>
    <td>Date:</td>
    <td><%= topic_date_format(@topic.publish_date) %></td>
  </tr>
  <tr>
    <td>Summary:</td>
    <td><%= simple_format("#{@topic.summary}") %></td>
  </tr>
</table>

<%= link_to "Edit", edit_topic_path(@topic) %><br>
<%= link_to "Back to Topic list", topics_path %>

<hr>

<% if @post %>
  <%= form_for @post do |f| %>
    <%= f.hidden_field :topic_id %>
    <%= f.label :platform %>
    <%= f.collection_select(:platform_id, Platform.all, :id, :name) %><br>
    <%= f.label :content %>:
    <%= f.text_area :content %><br>
    <%= f.label :posted_on %>:
    <%#= f.date_field :posted_on, class: "date_picker" %><br>
    <%= f.datetime_select :posted_on, default: post_date_default %><br>
    <%= f.submit "update post" %>
  <% end %>

<% else %>
  <%= form_for Post.new(topic_id: @topic.id) do |f| %>
    <%= f.hidden_field :topic_id %>
    <%= f.label :platform %>
    <%= f.collection_select(:platform_id, Platform.all, :id, :name) %><br>
    <%= f.label :content %>:
    <%= f.text_area :content %><br>
    <%= f.label :posted_on %>:
    <%#= f.date_field :posted_on, class: "date_picker" %><br>
    <%= f.datetime_select :posted_on, default: post_date_default %><br>
    <%= f.submit "Add post" %>
  <% end %>
<% end %>

<hr>

<table>
  <thead>
    <tr>
      <td></td>
      <td>Platform</td>
      <td>Content</td>
      <td>Count</td>
      <td>Scheduled for</td>
      <td>Status</td>
    </tr>
  </thead>
  <tbody>
  <% @topic.posts.each do |post| %>
    <tr class="post-row" id="<%= dom_id(post) %>">
      <td><%= link_to "Edit", edit_post_path(post) %></td>
      <td><%= post.platform.name if post.platform %></td>
      <td class="content"><%= post.content %></td>
      <td><%= post.content.length %></td>
      <td><%= post_date_format(post.posted_on) if post.posted_on %></td>
      <td><%= post.status %></td>
    </tr>
  <% end %>
  </tbody>
</table>